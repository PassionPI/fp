"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const{freeze:h,create:j}=Object;class w extends Array{}const d=e=>e instanceof w,i=e=>d(e)?e[0]?e:i():h(w.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),u=e=>d(e)?e:h(w.of(null,e)),p=[u,i],P=e=>new Proxy(e,{async apply(...t){try{return u(await Reflect.apply(...t))}catch(n){return i(n)}}}),g=Symbol(),R=(e,t)=>{const n=[];let r=-1,s=-1;for(;++r<e.length;)n.push(e[r]===g?t[++s]:e[r]);for(;++s<t.length;)n.push(t[s]);return n},T=e=>t=>{const n=r=>new Proxy(t,{apply(s,o,a){const l=R(r,a).slice(0,e);return l.length===e&&!l.includes(g)?Reflect.apply(s,o,l):n(l)}});return n([])},E=T(2),f=e=>new Promise(t=>setTimeout(t,e)),_=E((e,t)=>{let n=!0;const r=()=>{n=!1};return{loop:P(async()=>{for(n=!0,await f(e);n;)await t(),await f(e)}),stop:r}}),m=(...e)=>t=>{for(const n of e)t=n(t);return t},M=(...e)=>async t=>{for(const n of e)t=n(await t);return t},O=e=>{let t=null;return new Proxy(e,{async apply(...n){t==null&&(t=Promise.resolve(Reflect.apply(...n)));const r=await t;return t=null,r}})},v=m(O,P),x=e=>{let t=!1,n;return async()=>(t||(t=!0,n=await e()),n)},z=(e,t)=>n=>{const r=s=>{var o;return Promise.resolve(((o=e[s])!=null?o:t)(n,x(()=>r(s+1))))};return r(0)},F=()=>{let e,t;const n=new Promise((r,s)=>{[e,t]=[r,s]});return{resolve:e,reject:t,pending:n}};class L extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...p)}ap(t){return super.then(n=>n[0]?n:n[1](t)).then(...p)}}const N=e=>L.resolve(e).then(...p),S=Symbol(),b=Symbol(),y=e=>e&&e[S]==b,c=e=>{if(y(e))return e;if(!d(e))return c(u(e));const[t,n]=e;if(y(n))return n;const r=(o,a)=>{try{return c(u(o(a)))}catch(l){return c(i(l))}},s=j(null);return s[S]=b,s.join=()=>e,s.map=o=>t?s:r(o,n),s.ap=o=>t?s:r(n,o),h(s)},U=e=>{const t=new Map;return{get(n){const r=t.get(n);return t.has(n)&&(t.delete(n),t.set(n,r)),r},set(n,r){t.has(n)&&t.delete(n),t.set(n,r),t.size>e&&t.delete(t.keys().next().value)}}};exports.LRU=U;exports.asyncPipe=M;exports.either=P;exports.functor=c;exports.interval=_;exports.isFunctor=y;exports.lock=v;exports.oni=z;exports.pended=F;exports.pipe=m;exports.pipeline=N;exports.wait=f;
