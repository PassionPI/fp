"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});class l extends Array{}const{freeze:f}=Object,d=e=>e instanceof l,h=e=>d(e)?e[0]?e:h():f(l.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),m=e=>d(e)?e:f(l.of(null,e)),i=[m,h],c=e=>new Proxy(e,{apply(...t){return Promise.resolve().then(()=>Reflect.apply(...t)).then(...i)}}),y=e=>new Promise(t=>setTimeout(t,e)),P=e=>{let t=!0;return{loop:async(r,o=()=>{})=>{for(t=!0;t;)if(await y(e),t)try{await r()}catch(u){o(u)}},stop:()=>{t=!1}}},w=e=>{let t=!1,n=Promise.resolve();return new Proxy(c(e),{async apply(...s){return Promise.resolve().then(()=>(t==!1&&(n=Reflect.apply(...s),t=!0),n)).then(r=>(t=!1,r))}})},g=()=>{let e,t;const n=new Promise((s,r)=>{[e,t]=[s,r]});return{resolve:e,reject:t,pending:n}};class b extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...i)}}const j=e=>b.resolve(e).then(...i),p=()=>Promise.resolve(),x=(e,t=p)=>c(n=>{const s=async r=>{var a;let o=!1;return await((a=e[r])!=null?a:t)(n,()=>o?p():(o=!0,s(r+1)))};return s(0)});exports.either=c;exports.interval=P;exports.lock=w;exports.pended=g;exports.pipeline=j;exports.shuttle=x;exports.wait=y;
