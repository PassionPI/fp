"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const j=()=>{let e,t;const n=new Promise((r,o)=>{[e,t]=[r,o]});return{resolve:e,reject:t,pending:n}},{freeze:h,create:R}=Object;class w extends Array{}const d=e=>e instanceof w,i=e=>d(e)?e[0]?e:i():h(w.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),u=e=>d(e)?e:h(w.of(null,e)),p=[u,i],g=e=>new Proxy(e,{async apply(...t){try{return u(await Reflect.apply(...t))}catch(n){return i(n)}}}),P=Symbol(),T=(e,t)=>{const n=[];let r=-1,o=-1;for(;++r<e.length;)n.push(e[r]===P?t[++o]:e[r]);for(;++o<t.length;)n.push(t[o]);return n},E=e=>t=>{const n=r=>new Proxy(t,{apply(o,s,a){const l=T(r,a).slice(0,e);return l.length===e&&!l.includes(P)?Reflect.apply(o,s,l):n(l)}});return n([])},O=E(2),f=e=>new Promise(t=>setTimeout(t,e)),z=O((e,t)=>{let n=!0;const r=()=>{n=!1};return{loop:g(async()=>{for(n=!0,await f(e);n;)await t(),await f(e)}),stop:r}}),m=(...e)=>t=>{for(const n of e)t=n(t);return t},F=(...e)=>async t=>{for(const n of e)t=n(await t);return t},L=e=>{let t=null;return new Proxy(e,{async apply(...n){t==null&&(t=Promise.resolve(Reflect.apply(...n)));const r=await t;return t=null,r}})},M=m(L,g),N=e=>{let t=!1,n;return(...r)=>(t||(t=!0,n=e(...r)),n)},U=(e,t)=>{const n=(e==null?void 0:e.length)??0;return r=>{const o=async s=>s<n?await e[s](r,N(()=>o(s+1))):await t(r);return o(0)}};class _ extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...p)}ap(t){return super.then(n=>n[0]?n:n[1](t)).then(...p)}}const x=e=>_.resolve(e).then(...p),S=Symbol(),b=Symbol(),y=e=>e&&e[S]==b,c=e=>{if(y(e))return e;if(!d(e))return c(u(e));const[t,n]=e;if(y(n))return n;const r=(s,a)=>{try{return c(u(s(a)))}catch(l){return c(i(l))}},o=R(null);return o[S]=b,o.join=()=>e,o.map=s=>t?o:r(s,n),o.ap=s=>t?o:r(n,s),h(o)},A=e=>{const t=new Map;return{get(n){const r=t.get(n);return t.has(n)&&(t.delete(n),t.set(n,r)),r},set(n,r){t.has(n)&&t.delete(n),t.set(n,r),t.size>e&&t.delete(t.keys().next().value)}}};exports.LRU=A;exports.asyncPipe=F;exports.defer=j;exports.either=g;exports.functor=c;exports.interval=z;exports.isFunctor=y;exports.lock=M;exports.oni=U;exports.pipe=m;exports.pipeline=x;exports.wait=f;
