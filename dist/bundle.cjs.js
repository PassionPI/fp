"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const{freeze:h,create:j}=Object;class w extends Array{}const d=e=>e instanceof w,i=e=>d(e)?e[0]?e:i():h(w.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),u=e=>d(e)?e:h(w.of(null,e)),p=[u,i],P=e=>new Proxy(e,{async apply(...t){try{return u(await Reflect.apply(...t))}catch(n){return i(n)}}}),g=Symbol(),R=(e,t)=>{const n=[];let r=-1,o=-1;for(;++r<e.length;)n.push(e[r]===g?t[++o]:e[r]);for(;++o<t.length;)n.push(t[o]);return n},T=e=>t=>{const n=r=>new Proxy(t,{apply(o,s,a){const l=R(r,a).slice(0,e);return l.length===e&&!l.includes(g)?Reflect.apply(o,s,l):n(l)}});return n([])},E=T(2),f=e=>new Promise(t=>setTimeout(t,e)),O=E((e,t)=>{let n=!0;const r=()=>{n=!1};return{loop:P(async()=>{for(n=!0,await f(e);n;)await t(),await f(e)}),stop:r}}),m=(...e)=>t=>{for(const n of e)t=n(t);return t},x=(...e)=>async t=>{for(const n of e)t=n(await t);return t},z=e=>{let t=null;return new Proxy(e,{async apply(...n){t==null&&(t=Promise.resolve(Reflect.apply(...n)));const r=await t;return t=null,r}})},F=m(z,P),L=e=>{let t=!1,n;return()=>(t||(t=!0,n=e()),n)},M=(e,t)=>n=>{const r=o=>Promise.resolve((e[o]??t)(n,L(()=>r(o+1))));return r(0)},N=()=>{let e,t;const n=new Promise((r,o)=>{[e,t]=[r,o]});return{resolve:e,reject:t,pending:n}};class U extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...p)}ap(t){return super.then(n=>n[0]?n:n[1](t)).then(...p)}}const _=e=>U.resolve(e).then(...p),S=Symbol(),b=Symbol(),y=e=>e&&e[S]==b,c=e=>{if(y(e))return e;if(!d(e))return c(u(e));const[t,n]=e;if(y(n))return n;const r=(s,a)=>{try{return c(u(s(a)))}catch(l){return c(i(l))}},o=j(null);return o[S]=b,o.join=()=>e,o.map=s=>t?o:r(s,n),o.ap=s=>t?o:r(n,s),h(o)},v=e=>{const t=new Map;return{get(n){const r=t.get(n);return t.has(n)&&(t.delete(n),t.set(n,r)),r},set(n,r){t.has(n)&&t.delete(n),t.set(n,r),t.size>e&&t.delete(t.keys().next().value)}}};exports.LRU=v;exports.asyncPipe=x;exports.either=P;exports.functor=c;exports.interval=O;exports.isFunctor=y;exports.lock=F;exports.oni=M;exports.pended=N;exports.pipe=m;exports.pipeline=_;exports.wait=f;
