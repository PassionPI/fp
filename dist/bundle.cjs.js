"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const{freeze:a,create:g}=Object;class f extends Array{}const y=e=>e instanceof f,m=e=>y(e)?e[0]?e:m():a(f.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),u=e=>y(e)?e:a(f.of(null,e)),c=[u,m],w=e=>new Proxy(e,{apply(...t){return Promise.resolve().then(()=>Reflect.apply(...t)).then(...c)}}),i=e=>new Promise(t=>setTimeout(t,e)),j=e=>{let t=!0;const n=()=>{t=!1};return{loop:w(async r=>{for(t=!0,await i(e);t;)await r(),await i(e)}),stop:n}},d=(...e)=>t=>{for(const n of e)t=n(t);return t},T=(...e)=>async t=>{for(const n of e)t=n(await t);return t},E=e=>{let t=null;return new Proxy(e,{async apply(...n){t==null&&(t=Reflect.apply(...n));const o=await t;return t=null,o}})},k=d(E,w),O=()=>{let e,t;const n=new Promise((o,r)=>{[e,t]=[o,r]});return{resolve:e,reject:t,pending:n}};class _ extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...c)}ap(t){return super.then(n=>n[0]?n:n[1](t)).then(...c)}}const C=e=>_.resolve(e).then(...c),h=Symbol(),P=Symbol(),p=e=>e&&e[h]==P,l=e=>{if(p(e))return e;if(!y(e))return l(u(e));const[t,n]=e;if(p(n))return n;const o=(s,b)=>{try{return l(u(s(b)))}catch(S){return l(m(S))}},r=g(null);return r[h]=P,r.join=()=>e,r.map=s=>t?r:o(s,n),r.ap=s=>t?r:o(n,s),a(r)};exports.asyncCompose=T;exports.compose=d;exports.either=w;exports.functor=l;exports.interval=j;exports.isFunctor=p;exports.lock=k;exports.pended=O;exports.pipeline=C;exports.wait=i;
