"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});class s extends Array{}const{freeze:i}=Object,c=e=>e instanceof s,p=e=>c(e)?e[0]?e:p():i(s.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),d=e=>c(e)?e:i(s.of(null,e)),l=[d,p],a=e=>new Proxy(e,{apply(...t){return Promise.resolve().then(()=>Reflect.apply(...t)).then(...l)}}),u=e=>new Promise(t=>setTimeout(t,e)),h=e=>{let t=!0;return{loop:async(r,f=()=>{})=>{for(t=!0;t;)if(await u(e),t)try{await r()}catch(y){f(y)}},stop:()=>{t=!1}}},P=e=>{let t=!1,n=Promise.resolve();return new Proxy(a(e),{async apply(...o){return Promise.resolve().then(()=>(t==!1&&(n=Reflect.apply(...o),t=!0),n)).then(r=>(t=!1,r))}})},w=()=>{let e,t;const n=new Promise((o,r)=>{[e,t]=[o,r]});return{resolve:e,reject:t,pending:n}};class m extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...l)}}const g=e=>m.resolve(e).then(...l);exports.either=a;exports.interval=h;exports.lock=P;exports.pended=w;exports.pipeline=g;exports.wait=u;
