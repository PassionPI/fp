"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const{freeze:p,create:g}=Object;class a extends Array{}const f=e=>e instanceof a,y=e=>f(e)?e[0]?e:y():p(a.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),c=e=>f(e)?e:p(a.of(null,e)),m=[c,y],w=e=>new Proxy(e,{apply(...t){return Promise.resolve().then(()=>Reflect.apply(...t)).then(...m)}}),i=e=>new Promise(t=>setTimeout(t,e)),j=e=>{let t=!0;const n=()=>{t=!1};return{loop:w(async o=>{for(t=!0,await i(e);t;)await o(),await i(e)}),stop:n}},d=(...e)=>t=>{for(const n of e)t=n(t);return t},T=(...e)=>async t=>{for(const n of e)t=n(await t);return t},E=e=>{let t=null;return new Proxy(e,{async apply(...n){t==null&&(t=Reflect.apply(...n));const r=await t;return t=null,r}})},k=d(E,w),O=()=>{let e,t;const n=new Promise((r,o)=>{[e,t]=[r,o]});return{resolve:e,reject:t,pending:n}};class _ extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...m)}}const C=e=>_.resolve(e).then(...m),h=Symbol(),P=Symbol(),u=e=>e&&e[h]==P,l=e=>{if(u(e))return e;if(!f(e))return l(c(e));const[t,n]=e;if(u(n))return n;const r=(s,b)=>{try{return l(c(s(b)))}catch(S){return l(y(S))}},o=g(null);return o[h]=P,o.join=()=>e,o.map=s=>t?o:r(s,n),o.ap=s=>t?o:r(n,s),p(o)};exports.asyncCompose=T;exports.compose=d;exports.either=w;exports.functor=l;exports.interval=j;exports.isFunctor=u;exports.lock=k;exports.pended=O;exports.pipeline=C;exports.wait=i;
