"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});class i extends Array{}const{freeze:f}=Object,d=e=>e instanceof i,h=e=>d(e)?e[0]?e:h():f(i.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),y=e=>d(e)?e:f(i.of(null,e)),u=[y,h],o=e=>new Proxy(e,{apply(...t){return Promise.resolve().then(()=>Reflect.apply(...t)).then(...u)}}),l=e=>new Promise(t=>setTimeout(t,e)),P=e=>{let t=!0;const r=()=>{t=!1};return{loop:o(async n=>{for(t=!0,await l(e);t;)await n(),await l(e)}),stop:r}},w=e=>{let t=!1,r=Promise.resolve();return new Proxy(o(e),{async apply(...s){return Promise.resolve().then(()=>(t==!1&&(r=Reflect.apply(...s),t=!0),r)).then(n=>(t=!1,n))}})},m=()=>{let e,t;const r=new Promise((s,n)=>{[e,t]=[s,n]});return{resolve:e,reject:t,pending:r}};class g extends Promise{pipe(t){return super.then(r=>r[0]?r:t(r[1])).then(...u)}}const b=e=>g.resolve(e).then(...u),p=()=>Promise.resolve(),j=(e,t=p)=>o(r=>{const s=async n=>{var a;let c=!1;return((a=e[n])!=null?a:t)(r,()=>c?p():(c=!0,s(n+1)))};return s(0)});exports.either=o;exports.interval=P;exports.lock=w;exports.pended=m;exports.pipeline=b;exports.shuttle=j;exports.wait=l;
