"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const{freeze:p,create:S}=Object;class f extends Array{}const d=e=>e instanceof f,y=e=>d(e)?e[0]?e:y():p(f.of(e instanceof Error?e:Error(typeof e=="object"?JSON.stringify(e):String(e)),null)),i=e=>d(e)?e:p(f.of(null,e)),c=[i,y],h=e=>new Proxy(e,{apply(...t){return Promise.resolve().then(()=>Reflect.apply(...t)).then(...c)}}),u=e=>new Promise(t=>setTimeout(t,e)),j=e=>{let t=!0;const n=()=>{t=!1};return{loop:h(async o=>{for(t=!0,await u(e);t;)await o(),await u(e)}),stop:n}},w=(...e)=>t=>{for(const n of e)t=n(t);return t},T=(...e)=>async t=>{for(const n of e)t=n(await t);return t},E=e=>{let t=null;return new Proxy(e,{async apply(...n){t==null&&(t=Reflect.apply(...n));const r=await t;return t=null,r}})},R=w(E,h),M=e=>{let t=!1,n;return async()=>(t||(t=!0,n=await e()),n)},O=(e,t)=>n=>{const r=o=>{var s;return((s=e[o])!=null?s:t)(n,M(()=>r(o+1)))};return r(0)},_=()=>{let e,t;const n=new Promise((r,o)=>{[e,t]=[r,o]});return{resolve:e,reject:t,pending:n}};class z extends Promise{pipe(t){return super.then(n=>n[0]?n:t(n[1])).then(...c)}ap(t){return super.then(n=>n[0]?n:n[1](t)).then(...c)}}const F=e=>z.resolve(e).then(...c),P=Symbol(),g=Symbol(),a=e=>e&&e[P]==g,l=e=>{if(a(e))return e;if(!d(e))return l(i(e));const[t,n]=e;if(a(n))return n;const r=(s,m)=>{try{return l(i(s(m)))}catch(b){return l(y(b))}},o=S(null);return o[P]=g,o.join=()=>e,o.map=s=>t?o:r(s,n),o.ap=s=>t?o:r(n,s),p(o)},L=e=>{const t=new Map;return{get(n){const r=t.get(n);return t.has(n)&&(t.delete(n),t.set(n,r)),r},set(n,r){t.has(n)&&t.delete(n),t.set(n,r),t.size>e&&t.delete(t.keys().next().value)}}};exports.LRU=L;exports.asyncPipe=T;exports.either=h;exports.functor=l;exports.interval=j;exports.isFunctor=a;exports.lock=R;exports.oni=O;exports.pended=_;exports.pipe=w;exports.pipeline=F;exports.wait=u;
